# 项目推进流程：LSTM/GRU 时间序列预测智能体

## 1. 项目概述
**选题：** 从LSTM、RNN和GRU中选取两种回归算法进行智能体封装
**目标：** 构建一个深度学习智能体，能够接收时间序列数据（如股票价格、气温变化），分别使用 LSTM 和 GRU 两种模型进行训练，并对比它们的预测效果，最后使用表现更好的模型预测未来的数值。
**技术栈推荐：** Python, `TensorFlow/Keras` (或 `PyTorch`), `pandas`, `matplotlib`, `yfinance` (获取股票数据)。

### 1.1 选题原因（为什么选这个作为“深度学习”里的入门项？）
1.  **数据极易在获取：** 相比于图像识别（Yolo）需要下载几GB的图片并进行复杂的标注（画框），本选题只需要一列数字（例如过去30天的股价）。使用 `yfinance` 库一行代码就能下载最新的股票数据。
2.  **网络结构简单：** 相比于成百上千层的卷积网络，处理简单时间序列的 LSTM/GRU 模型通常只需要 2-3 层（输入层 -> LSTM层 -> 全连接层），代码量极少，易于理解深度学习的“搭积木”过程。
3.  **计算资源需求低：** 这种一维数据的训练非常快，即使没有高端显卡，使用普通 CPU 也能在几分钟内完成训练，反馈迅速。
4.  **经典入门场景：** “股票预测”或“气温预测”是深度学习最经典的 Hello World 级案例之一，网上教程和代码片段非常丰富。

---

## 2. 阶段一：环境与数据获取 (第1-2天)

### 2.1 环境搭建
这个项目需要深度学习框架。
```bash
python -m venv venv
# 激活环境后
pip install tensorflow pandas matplotlib yfinance scikit-learn
# 或者使用 pytorch
```

### 2.2 数据准备工具
编写 `data_loader.py`。
*   **功能：** 使用 `yfinance` 下载某只股票（如 Apple: AAPL）过去一年的收盘价。
*   **预处理（关键）：**
    *   **归一化：** 神经网络喜欢 0-1 之间的数据，使用 `MinMaxScaler` 把股价缩放到 0-1。
    *   **构建序列：** 把一长串数字切成样本。例如：用“前10天”的数据（X）预测“第11天”的数据（y）。

---

## 3. 阶段二：模型构建与训练 (第3-5天)

### 3.1 定义模型
编写 `models.py`，定义两个函数分别构建模型。
*   **LSTM 模型：** `Sequential([ LSTM(50, return_sequences=False), Dense(1) ])`
*   **GRU 模型：** `Sequential([ GRU(50, return_sequences=False), Dense(1) ])`
*   这两个模型结构几乎一样，只是核心层的名字不同，非常适合做对比。

### 3.2 训练与对比
编写 `train_agent.py`。
*   **输入：** 准备好的 X_train, y_train。
*   **过程：**
    1.  实例化 LSTM 模型，调用 `.fit()` 训练 20-50 个 epochs。
    2.  实例化 GRU 模型，调用 `.fit()` 训练同样轮数。
*   **损失函数：** 使用 MSE (均方误差)，这是回归问题最常用的指标。

---

## 4. 阶段三：智能体封装与预测 (第6天)

### 4.1 智能体逻辑 `PredictionAgent`
*   **任务：** 对比两个模型在测试集上的 Loss（误差）。
*   **决策：** 如果 `LSTM_loss < GRU_loss`，则标记 LSTM 为“优胜模型”。
*   **预测：** 使用优胜模型，输入最近已知的那段数据，预测明天的股价（或气温）。

### 4.2 反归一化
*   记得把模型预测出来的 0-1 之间的小数，用之前的 Scaler 转回真实的股价（如 150.5 美元），否则用户看不懂。

---

## 5. 阶段四：可视化与展示 (第7天)

### 5.1 结果可视化
画一张图，包含三条线：
1.  **真实数据**（黑线）
2.  **LSTM 预测轨迹**（蓝线）
3.  **GRU 预测轨迹**（红线）
*   这样能非常直观地看到哪个模型更贴合真实走势。

### 5.2 项目产出
*   **最终演示：** 运行脚本，输入股票代号（如 AAPL），程序自动下载数据 -> 训练 -> 弹出对比图 -> 输出“推荐使用 GRU 模型，预测明天价格为 $182.5”。
*   **文档：** 再次强调，不要真的用来炒股！只是学习算法。

---

## 6. 代码结构示例

```text
project/
│
├── data_loader.py     # 下载股票数据并处理成 dataset
├── models.py          # 定义 LSTM 和 GRU 网络结构
├── agent.py           # 负责调度训练、对比和预测
├── main.py            # 主程序
└── requirements.txt   # 依赖列表
```